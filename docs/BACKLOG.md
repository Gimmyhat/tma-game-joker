# Бэклог и План развития (TMA Joker)

Этот документ содержит задачи и архитектурные решения, запланированные для будущих обновлений.

## 1. История игр и Администрирование (Важно для Production)

Необходимо реализовать персистентное хранение истории каждой партии для разрешения споров и аналитики.

### Архитектурное решение:

Использовать стратегию **"Периодический дамп состояния"** (Snapshotting).

- **Хранилище:** PostgreSQL, таблица `games`, колонка `replay_data` (тип `JSONB`).
- **Что сохранять:** Массив `history: RoundHistory[]` из `GameState`. Это уже содержит все ходы, ставки и результаты по раундам.
- **Когда сохранять:**
  1.  **Конец пульки (PulkaComplete):** Обновлять запись в БД. Это минимизирует нагрузку (всего 4 записи на игру) и риск потери данных при сбое сервера (максимум 1 пулька).
  2.  **Конец игры (GameFinished):** Финальное сохранение полной истории и победителя.

### Техническая реализация:

1.  В `GameEngineService` или `GameGateway`:
    - При переходе в фазу `PulkaComplete` и `Finished` вызывать `DatabaseService.saveGameHistory(gameId, history)`.
2.  Создать API эндпоинт `GET /games/:id/history` (доступ только для Admin).
3.  В Админке сделать визуализатор: загружать JSON и показывать таблицу ходов.

## 2. Улучшение Стабильности (Dev Ops)

- **Graceful Shutdown:** При перезагрузке сервера сохранять текущие стейты всех активных игр в Redis/DB, чтобы после рестарта восстановить их.
- **Reconnect:** Улучшить UX переподключения (сейчас работает, но можно добавить "Ожидание игрока..." для остальных).

## 3. UI/UX

- **Анимации:** Добавить анимацию раздачи карт (сейчас они появляются мгновенно).
- **Звуки:** Добавить звуковые эффекты (ход, победа, ошибка).
