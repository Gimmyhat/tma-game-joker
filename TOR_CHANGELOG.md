# TOR_CHANGELOG

## v0.5 (2026-01-24) — Исправление механики джокера

- **Источник**: Анализ правил грузинского покера (Pagat.com, Wikipedia).
- **Проблема обнаружена**:
  - Frontend (`JokerOptionModal.tsx`) показывал все 4 опции джокера в любой момент.
  - Правильно: опции зависят от позиции в взятке.
- **Исправлено**:
  - `JokerOptionModal.tsx`: добавлен проп `isLeading`, фильтрация опций.
  - `GameScreen.tsx`: передаёт `isLeading={gameState.table.length === 0}`.
- **Правильная механика джокера**:
  - **Ведение взятки** (первый ход): High/Low + выбор масти.
  - **Не первый ход**: Top/Bottom (бьёт/не бьёт).
- **Backend**: Валидация была корректной (`move.validator.ts`), изменений не требуется.
- **Status**: IMPLEMENTED.

## v0.4 (2026-01-22) — Q9 закрыт

- **Источник**: Исследование правил "Популярного" (Грузинского) Джокера.
- **Решено**:
  - Q9 (структура раундов) — подтверждена структура 8+4+8+4=24.
  - Пулька 2: 4 раздачи по 9 карт (с выбором козыря).
  - Пулька 4: 4 раздачи по 9 карт (копия Пульки 2).
- **Обновлено**:
  - ROADMAP.md: исправлена структура раундов (раунды 9-12 и 21-24).
  - DEVELOPMENT_PLAN.md: версия 1.1 → 1.2, убран блокер, добавлена таблица структуры.
  - docs/Правила и механика игры Joker.md: уточнено описание 2-го круга.
- **Status**: READY FOR DEVELOPMENT (Sprint 0 can start).

## v0.3 (2026-01-22) — Ревизия документации

- **Источник**: Анализ соответствия TOR ↔ ROADMAP ↔ Правила игры.
- **Критические находки**:
  - Обнаружено противоречие в структуре раундов/пулек (Q9 добавлен в OPEN_QUESTIONS как High Priority Blocker).
  - ROADMAP описывает Пульку 4 как "раздачи по 2-8 карт", правила — как "копия пульки 2" (по 9 карт).
- **Технические риски**:
  - Логика сравнения двух Джокеров "Top" некорректна (нет порядка ходов).
  - Логика премий не полностью соответствует правилам (соседство на премии).
  - Не обработан кейс "Джокер как козырь → игра без козырей".
  - Валидация ответа на Джокер "High" (высшая карта) отсутствует.
- **Изменено в DEVELOPMENT_PLAN**:
  - Версия: 1.0 → 1.1.
  - Sprint 4: добавлен буфер +3 дня.
  - S3-12 (drag & drop): SHOULD → MUST.
  - Добавлена задача S3-0 (анализ Figma).
  - Добавлена секция "Известные технические риски".
- **Status**: DRAFT (requires Q9 resolution before Sprint 1).

## v0.2 (2026-01-21)

- **Источник**: Анализ `ROADMAP.md` (техническая спецификация).
- **Изменено**:
  - Добавлен срок разработки: 7-8 недель.
  - Добавлена ожидаемая нагрузка: 100-200 игр.
  - REQ-4 (Подсчет очков): детализированы формулы (AC1-AC6).
  - REQ-5 (UI): добавлен AC4 (таймер хода).
- **Добавлено**:
  - REQ-6: Лобби и Матчмейкинг (4 AC).
  - REQ-7: Сетевая устойчивость / Reconnect (4 AC).
  - Раздел 4 (NFR): заполнены конкретные значения.
  - Раздел 5 (Этапы): план из 4 этапов.
  - Раздел 6 (Definition of Done): 5 критериев завершения.
  - Раздел 9 (Технологический стек): рекомендуемый стек.
- **Перенесено в Out of scope**:
  - Leaderboard (требует уточнения Q7).
  - История игр (требует уточнения Q6).
- **Закрыто вопросов**: Q1 (частично), Q2 (частично), Q3, Q4.
- **Status**: DRAFT (not for signing).

## v0.1 (2026-01-21)

- Initial draft created from client brief.
- Status: DRAFT (not for signing).
